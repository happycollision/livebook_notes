<!-- livebook:{"persist_outputs":true} -->

# EOM averages

```elixir
name = "Deidentified Public Use Baseline Episode File-CY 2020.csv"
input = "#{__DIR__}/#{name}" |> File.stream!()
```

<!-- livebook:{"output":true} -->

```
%File.Stream{
  path: "/Users/dondenton/GitProjects/livebook_notes/eom_calculator/Deidentified Public Use Baseline Episode File-CY 2020.csv",
  modes: [:raw, :read_ahead, :binary],
  line_or_bytes: :line,
  raw: true
}
```

## prep the data

```elixir
values =
  input
  |> Stream.map(&String.split(&1, ",", trim: true))

[header] =
  values
  |> Stream.take(1)
  |> Enum.into([])

data_stream =
  values
  |> Stream.drop(1)
  |> Stream.map(fn row ->
    Enum.zip(header, row) |> Enum.into(%{})
  end)

data_stream |> Enum.count()
```

<!-- livebook:{"output":true} -->

```
184772
```

## filtering

Just before we get some filtering functions ready to go, it might be good to layout the shape of the data.

### EOM Data Dictionary for the Deidentified Public Use Baseline Episode Files

Fun fact about this data: columns are not capitalized in the way this dictionary claims. It's the wild west.

<details>

| Variable                | Variable Label                                                                         | Data Type | Data Length | Details                                                                                                                                                                          | Comments                                                                                                                                                                                                                                                                 |
| ----------------------- | -------------------------------------------------------------------------------------- | --------- | ----------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| EPISODE_ID              | Episode Identification Number                                                          | Num       | 8           | OCF Episode Id                                                                                                                                                                   | Unique number identifying each episode                                                                                                                                                                                                                                   |
| DE_BENEID_PUF           | EOM Deidentified BENE_ID                                                               | Char      | 15          | EOM Deidentified CCW BENE_ID                                                                                                                                                     | -                                                                                                                                                                                                                                                                        |
| DE_PGP_ID_PUF           | EOM Deidentified Program Practice ID                                                   | Char      | 15          | EOM Deidentified Attributed TIN                                                                                                                                                  | -                                                                                                                                                                                                                                                                        |
| EPSBEG                  | Episode Beginning Date                                                                 | Num       | 8           | Episode Beginning Date                                                                                                                                                           | Format: CCYYMMDD                                                                                                                                                                                                                                                         |
| EPSEND                  | Episode Ending Date                                                                    | Num       | 8           | Episode Ending Date                                                                                                                                                              | Format: CCYYMMDD                                                                                                                                                                                                                                                         |
| EPISODE                 | Episode number across all BPx                                                          | Num       | 8           | Episode number across all BPx                                                                                                                                                    | Codes: 1- 8                                                                                                                                                                                                                                                              |
| BL_EPISODE              | Episode number (within the BP, and will mostly be 1)                                   | Num       | 1           | Episode number (within the BP, and will mostly be 1)                                                                                                                             | -                                                                                                                                                                                                                                                                        |
| EP_LNGTH                | Episode Length                                                                         | Num       | 8           | Episode duration: number of days                                                                                                                                                 | Value Codes: 180 - 184                                                                                                                                                                                                                                                   |
| CANCER_TYPE             | Cancer Type                                                                            | Char      | 158         | Assigned Cancer Type                                                                                                                                                             | Value Codes: Breast cancer Chronic leukemia Lung cancer Lymphoma Multiple myeloma Prostate cancer Small intestine/colorectal cancer                                                                                                                                      |
| SECOND_CANCER_TYPE      | Secondary Cancer Diagnosis                                                             | Char      | 150         | Secondary Cancer Diagnosis                                                                                                                                                       | Value Codes: Breast cancer Chronic leukemia Lung cancer Lymphoma Multiple myeloma Prostate cancer Small intestine/colorectal cancer                                                                                                                                      |
| TRIGGER_SOURCE          | Episode trigger source                                                                 | Char      | 3           | Episode trigger source; Medicare claim type source                                                                                                                               | Value Codes: OUT (outpatient claim) PHY (carrier claim) DME (DME claim) PDE (Part D Event)                                                                                                                                                                               |
| BENE_RACE_CD            | Race Code                                                                              | Char      | 1           | Beneficiary Race Code                                                                                                                                                            | EDB Race Codes: 0 = Unknown 1 = White 2 = Black 3 = Other 4 = Asian 5 = Hispanic 6 = North American Indian or Alaskan Native                                                                                                                                             |
| FEMALE_AGE_18_64        | Female Between 18 and 64 Years                                                         | Num       | 8           | Female Between 18 and 64 Years                                                                                                                                                   | Value Codes: 1 = Age at the beginning of the episode between 18 and 64 and MBSF Sex = Female 0 = Beneficiary did not meet criteria                                                                                                                                       |
| MALE_AGE_18_64          | Male Between 18 and 64 Years                                                           | Num       | 8           | Male Between 18 and 64 Years                                                                                                                                                     | Value Codes: 1 = Age at the beginning of the episode between 18 and 64 and MBSF Sex = Male 0 = Beneficiary did not meet criteria                                                                                                                                         |
| FEMALE_AGE_65_69        | Female Between 65 and 69 Years                                                         | Num       | 8           | Female Between 65 and 69 Years                                                                                                                                                   | Value Codes: 1 = Age at the beginning of the episode between 65 and 69 and MBSF Sex = Female 0 = Beneficiary did not meet criteria                                                                                                                                       |
| MALE_AGE_65_69          | Male Between 65 and 69 Years                                                           | Num       | 8           | Male Between 65 and 69 Years                                                                                                                                                     | Value Codes: 1 = Age at the beginning of the episode between 65 and 69 and MBSF Sex = Male 0 = Beneficiary did not meet criteria                                                                                                                                         |
| FEMALE_AGE_70_74        | Female Between 70 and 74 Years                                                         | Num       | 8           | Female Between 70 and 74 Years                                                                                                                                                   | Value Codes: 1 = Age at the beginning of the episode between 70 and 74 and MBSF Sex = Female 0 = Beneficiary did not meet criteria                                                                                                                                       |
| MALE_AGE_70_74          | Male Between 70 and 74 Years                                                           | Num       | 8           | Male Between 70 and 74 Years                                                                                                                                                     | Value Codes: 1 = Age at the beginning of the episode between 70 and 74 and MBSF Sex = Male 0 = Beneficiary did not meet criteria                                                                                                                                         |
| FEMALE_AGE_75_79        | Female Between 75 and 79 Years                                                         | Num       | 8           | Female Between 75 and 79 Years                                                                                                                                                   | Value Codes: 1 = Age at the beginning of the episode between 75 and 79 and MBSF Sex = Female 0 = Beneficiary did not meet criteria                                                                                                                                       |
| MALE_AGE_75_79          | Male Between 75 and 79 Years                                                           | Num       | 8           | Male Between 75 and 79 Years                                                                                                                                                     | Value Codes: 1 = Age at the beginning of the episode between 75 and 79 and MBSF Sex = Male 0 = Beneficiary did not meet criteria                                                                                                                                         |
| FEMALE_AGE_80           | Female Between 80 or More Years                                                        | Num       | 8           | Female 80 or more Years                                                                                                                                                          | Value Codes: 1 = Age at the beginning of the episode greater than or equal to 80 and MBSF Sex = Female 0 = Beneficiary did not meet criteria                                                                                                                             |
| MALE_AGE_80             | Male Between 80 or More Years                                                          | Num       | 8           | Male 80 or more Years                                                                                                                                                            | Value Codes: 1 = Age at the beginning of the episode greater than or equal to 80 and MBSF Sex = Male 0 = Beneficiary did not meet criteria                                                                                                                               |
| RTI_RACE_CD             | Research Triangle Institute (RTI) Race Code                                            | Char      | 1           | Research Triangle Institute (RTI) Race Code                                                                                                                                      | Value Codes: 0 = Unknown 1 = White 2 = Black 3 = Other 4 = Asian 5 = Hispanic 6 = North American Native                                                                                                                                                                  |
| LTI                     | Institutional Status at the Beginning of the Episode                                   | Num       | 8           | Institutional Status at the Beginning of the Episode                                                                                                                             | Value Codes: 1 = Yes, beneficiary was institutionalized in a long term care facility for more than 90 days at the beginning of episode 0 = No                                                                                                                            |
| FORHP_RURAL_IND         | FORHP Rural Indicator                                                                  | Num       | 8           | FORHP Rural Indicator                                                                                                                                                            | Value Codes: 1 = Yes, the provider zip code is found in FOHRP eligible ZIP Codes File 0 = No                                                                                                                                                                             |
| RUCA_RURAL_IND          | RUCA Rural Indicator                                                                   | Num       | 8           | RUCA Rural Indicator                                                                                                                                                             | Value Codes: 1 = Yes, RUCA1 is between 4 and 10, inclusive 0 = No                                                                                                                                                                                                        |
| RUCA1                   | Primary RUCA code                                                                      | Num       | 8           | Geographic Indicator                                                                                                                                                             | -                                                                                                                                                                                                                                                                        |
| RUCA2                   | Secondary RUCA code                                                                    | Num       | 8           | Geographic Indicator                                                                                                                                                             | -                                                                                                                                                                                                                                                                        |
| PGP_ID_REGION           | Attributed Practice Census Region                                                      | Char      | 16          | Census region of the Attributed TIN that was attributed the episode                                                                                                              | Value Codes: Midwest Region Northeast Region South Region West Region                                                                                                                                                                                                    |
| PRCHEMO1_61             | Clean period between one and 61 days                                                   | Num       | 8           | Between 1 and 61 Days Since Last Chemo                                                                                                                                           | Value Codes: 1 = Between 1 and 61 Days Since Last Chemo 0 = Otherwise                                                                                                                                                                                                    |
| PRCHEMO62_730           | Clean period between 61 and 730 days                                                   | Num       | 8           | Between 62 and 730 Days Since Last Chemo                                                                                                                                         | Value Codes: 1 = Between 62 and 730 Days Since Last Chemo 0 = Otherwise                                                                                                                                                                                                  |
| PRCHEMO_731             | Clean period larger than 730 days OR no prior Chemo                                    | Num       | 8           | More than 730 Days Since Last Chemo OR No Previous Chemo                                                                                                                         | Value Codes: 1 = More than 730 Days Since Last Chemo OR No Previous Chemo 0 = Otherwise                                                                                                                                                                                  |
| HCC_NEW                 | New enrollee OR enrollee for which the HCC risk scores are missing                     | Num       | 8           | New Enrollee OR Missing HCC                                                                                                                                                      | Value Codes: 1 = beneficiary was a new Medicare enrollee, or if the beneficiary was missing from the CMS-HCC dataset 0 = Not new enrollee                                                                                                                                |
| PRIMARY_OBESITY         | Primary Comorbidity: Obesity                                                           | Num       | 8           | 8 Primary HCC Groups. Flag identifying the primary comorbidities indicated by CMS-HCC and CMS-RxHCC risk models                                                                  | Value Codes: 1 = HCC_New=0 and HCC22 or RxHCC43 0 = Otherwise                                                                                                                                                                                                            |
| PRIMARY_COPD            | Primary Comorbidity: COPD                                                              | Num       | 8           | 8 Primary HCC Groups. Flag identifying the primary comorbidities indicated by CMS-HCC and CMS-RxHCC risk models                                                                  | Value Codes: 1 = HCC_New=0 and HCC111 0 = Otherwise                                                                                                                                                                                                                      |
| PRIMARY_DEMENTIA        | Primary Comorbidity: Dementia                                                          | Num       | 8           | 8 Primary HCC Groups. Flag identifying the primary comorbidities indicated by CMS-HCC and CMS-RxHCC risk models                                                                  | Value Codes: 1 = HCC_New=0 and HCC51, HCC52, RxHCC111, OR RxHCC112 0 = Otherwise                                                                                                                                                                                         |
| PRIMARY_HYPERTENSION    | Primary Comorbidity: Hypertension                                                      | Num       | 8           | 8 Primary HCC Groups. Flag identifying the primary comorbidities indicated by CMS-HCC and CMS-RxHCC risk models                                                                  | Value Codes: 1 = HCC_New=0 and HCC107, HCC108, RxHCC215, OR RxHCC187 0 = Otherwise                                                                                                                                                                                       |
| PRIMARY_HEMATO          | Primary Comorbidity: Hematological Disorder                                            | Num       | 8           | 8 Primary HCC Groups. Flag identifying the primary comorbidities indicated by CMS-HCC and CMS-RxHCC risk models                                                                  | Value Codes: 1 = HCC_New=0 and HCC46, HCC48, RxHCC95, RxHCC96, OR RxHCC98 0 = Otherwise                                                                                                                                                                                  |
| PRIMARY_AUTOIMMUNE      | Primary Comorbidity: Autoimmune Disorder                                               | Num       | 8           | 8 Primary HCC Groups. Flag identifying the primary comorbidities indicated by CMS-HCC and CMS-RxHCC risk models                                                                  | Value Codes: 1 = HCC_New=0 and HCC40, HCC75, HCC77, RxHCC82, RxHCC83, RxHCC84, RxHCC159, OR RxHCC160 0 = Otherwise                                                                                                                                                       |
| PRIMARY_ENDOCRINE       | Primary Comorbidity: Endocrine Disorder                                                | Num       | 8           | 8 Primary HCC Groups. Flag identifying the primary comorbidities indicated by CMS-HCC and CMS-RxHCC risk models                                                                  | Value Codes: 1 = HCC_New=0 and HCC17, HCC18, HCC19, HCC23, HCC122, RxHCC30, RxHCC31, RxHCC40, RxHCC41, RxHCC42, OR RxHCC241 0 = Otherwise                                                                                                                                |
| PRIMARY_HEARTDIS        | Primary Comorbidity: Heart Disease                                                     | Num       | 8           | 8 Primary HCC Groups. Flag identifying the primary comorbidities indicated by CMS-HCC and CMS-RxHCC risk models                                                                  | Value Codes: 1 = if HCC_New=0 and HCC84, HCC85, HCC86, HCC87, HCC88, HCC96, RxHCC185, RxHCC186, RxHCC188, OR RxHCC193 0 = Otherwise                                                                                                                                      |
| ALLOGENEIC              | Bone marrow transplant-Allogeneic                                                      | Num       | 8           | Allogeneic Bone Marrow Transplant                                                                                                                                                | Value Codes: 1 = Patient had a bone marrow transplant during the episode (only "Yes" for cancer types of Chronic Leukemia, Lymphoma, or Multiple Myeloma) and Allogeneic transplant 0 = No Bone marrow transplant-Allogeneic                                             |
| AUTOLOGOUS              | Bone marrow transplant-autologous                                                      | Num       | 8           | Autologous Bone Marrow Transplant                                                                                                                                                | Value Codes: 1 = Patient had a bone marrow transplant during the episode (only "Yes" for cancer types of Chronic Leukemia, Lymphoma, or Multiple Myeloma) and Autologous transplant 0 = No Bone marrow transplant-autologous                                             |
| CLINICAL_TRIAL          | Clinical trial participation                                                           | Num       | 8           | Beneficiary in Clinical Trial During Episodes                                                                                                                                    | Value Codes: 1 = Patient participated in a clinical trial for cancer during the episode 0 = No                                                                                                                                                                           |
| FULL_DUAL               | Full Dual Status Beginning of the Episode.                                             | Num       | 8           | Enrollment status in Medicare Part D at beginning of episode Enrolled in Part D, full dual, LIS                                                                                  | Value Codes: 1 = Yes, the dual status code in the month that the episode began is 02, 04, or 08 and the Medicare cost share group code in the month the episode began is 01 – 08 0 = No                                                                                  |
| PART_D_LIS              | Not Dual, Part D and Low Income Subsidy at the Beginning of the Episode                | Num       | 8           | Enrollment status in Medicare Part D at beginning of episode Enrolled in Part D, NOT full dual, LIS                                                                              | Value Codes: 1 = Yes, the dual status code in the month that the episode began is NOT (02, 04, or 08) and the Medicare cost share group code in the month the episode began is 01 – 08 0 = No                                                                            |
| PART_D_NO_LIS           | Dual/Part D/Low Income Subsidy (LIS) status                                            | Num       | 8           | Enrollment status in Medicare Part D at beginning of episode Enrolled in Part D, no LIS                                                                                          | Value Codes: 1 = Yes, the Medicare cost share group code in the month the episode began is 09 0 = No                                                                                                                                                                     |
| PART_D                  | Part D at the beginning of Episode                                                     | Num       | 8           | Enrollment status in Medicare Part D at beginning of episode Enrolled in Part D                                                                                                  | Value Codes: 1 = Yes, the dual status code in the month that the episode began is NOT (02, 04, or 08) and the Medicare cost share group code in the month the episode began is 01 – 08 OR the Medicare cost share group code in the month the episode began is 09 0 = No |
| NO_PART_D               | No Part D at the beginning of Episode                                                  | Num       | 8           | Enrollment status in Medicare Part D at beginning of episode Not enrolled in Part D                                                                                              | Value Codes: 1 = Yes, the Medicare cost share group code in the month the episode began is 10 – 13 or missing 0 = No                                                                                                                                                     |
| CANCER_SURGERY          | Surgery                                                                                | Num       | 8           | Cancer Related Surgery during the Episode                                                                                                                                        | Value Codes: 1 = Yes, a cancer-related surgery occurred within the episode 0 = No                                                                                                                                                                                        |
| RADIATION_THERAPY       | Radiation therapy                                                                      | Num       | 8           | Radiation Therapy during the Episode                                                                                                                                             | Value Codes: 1 = Yes, radiation treatment happened within the episode 0 = No                                                                                                                                                                                             |
| PRECOVID_DAYS           | Count of Days Since the Most Recent COVID 19 Claim Preceding the Episode Start         | Num       | 8           | Continuous variable that shows the length of time between last claim with a COVID19 diagnosis and episode beginning date                                                         | -                                                                                                                                                                                                                                                                        |
| PRCHEMO_LYMPH1_30       | Lymphoma: Prior Chemotherapy between 1 and 30 days before Episode Start                | Num       | 8           | Lymphoma: Prior Chemotherapy between 1 and 30 days before Episode Start                                                                                                          | Value Codes: 1 = Prior Chemotherapy between 1 and 30 days before episode start and Cancer Type= "Lymphoma" 0 = No                                                                                                                                                        |
| PRCHEMO_LYMPH31_60      | Lymphoma: Prior Chemotherapy between 31 and 60 days before Episode Start               | Num       | 8           | Lymphoma: Prior Chemotherapy between 31 and 60 days before Episode Start                                                                                                         | Value Codes: 1 = Prior Chemotherapy between 31 and 60 days before episode start and Cancer Type= "Lymphoma" 0 = No                                                                                                                                                       |
| PRCHEMO_LYMPH61_90      | Lymphoma: Prior Chemotherapy between 61 and 90 days before Episode Start               | Num       | 8           | Lymphoma: Prior Chemotherapy between 61 and 90 days before Episode Start                                                                                                         | Value Codes: 1 = Prior Chemotherapy between 61 and 90 days and Cancer Type= "Lymphoma" 0 = No                                                                                                                                                                            |
| PRCHEMO_LYMPH91_120     | Lymphoma: Prior Chemotherapy between 91 and 120 days before Episode Start              | Num       | 8           | Lymphoma: Prior Chemotherapy between 91 and 120 days before Episode Start                                                                                                        | Value Codes: 1 = Prior Chemotherapy between 91 and 120 days before episode start and Cancer Type= "Lymphoma" 0 = No                                                                                                                                                      |
| PRCHEMO_LYMPH121_150    | Lymphoma: Prior Chemotherapy between 121 and 150 days before Episode Start             | Num       | 8           | Lymphoma: Prior Chemotherapy between 121 and 150 days before Episode Start                                                                                                       | Value Codes: 1 = Prior Chemotherapy between 121 and 150 days before episode start and Cancer Type= "Lymphoma" 0 = No                                                                                                                                                     |
| PRCHEMO_LYMPH151_180    | Lymphoma: Prior Chemotherapy between 151 and 180 days before Episode Start             | Num       | 8           | Lymphoma: Prior Chemotherapy between 151 and 180 days before Episode Start                                                                                                       | Value Codes: 1 = Prior Chemotherapy between 151 and 180 days before episode start and Cancer Type= "Lymphoma" 0 = No                                                                                                                                                     |
| PRCHEMO_LYMPH181_270    | Lymphoma: Prior Chemotherapy between 181 and 270 days before Episode Start             | Num       | 8           | Lymphoma: Prior Chemotherapy between 181 and 270 days before Episode Start                                                                                                       | Value Codes: 1 = Prior Chemotherapy between 181 and 270 days before episode start and Cancer Type= "Lymphoma" 0 = No                                                                                                                                                     |
| PRCHEMO_LYMPH271_360    | Lymphoma: Prior Chemotherapy between 271 and 360 days before Episode Start             | Num       | 8           | Lymphoma: Prior Chemotherapy between 271 and 360 days before Episode Start                                                                                                       | Value Codes: 1 = Prior Chemotherapy between 271 and 360 days before episode start and Cancer Type= "Lymphoma" 0 = No                                                                                                                                                     |
| PRCHEMO_LYMPH361_450    | Lymphoma: Prior Chemotherapy between 361 and 450 days before Episode Start             | Num       | 8           | Lymphoma: Prior Chemotherapy between 361 and 450 days before Episode Start                                                                                                       | Value Codes: 1 = Prior Chemotherapy between 361 and 450 days before episode start and Cancer Type= "Lymphoma" 0 = No                                                                                                                                                     |
| PRCHEMO_LYMPH451_540    | Lymphoma: Prior Chemotherapy between 451 and 540 days before Episode Start             | Num       | 8           | Lymphoma: Prior Chemotherapy between 451 and 540 days before Episode Start                                                                                                       | Value Codes: 1 = Prior Chemotherapy between 451 and 540 days before episode start and Cancer Type= "Lymphoma" 0 = No                                                                                                                                                     |
| PRCHEMO_LYMPH541_630    | Lymphoma: Prior Chemotherapy between 541 and 630 days before Episode Start             | Num       | 8           | Lymphoma: Prior Chemotherapy between 541 and 630 days before Episode Start                                                                                                       | Value Codes: 1 = Prior Chemotherapy between 541 and 630 days and Cancer Type= "Lymphoma" 0 = No                                                                                                                                                                          |
| PRCHEMO_LYMPH631_720    | Lymphoma: Prior Chemotherapy between 631 and 720 days before Episode Start             | Num       | 8           | Lymphoma: Prior Chemotherapy between 631 and 720 days before Episode Start                                                                                                       | Value Codes: 1 = Prior Chemotherapy between 631 and 720 days before episode start and Cancer Type= "Lymphoma" 0 = No                                                                                                                                                     |
| PRCHEMO_LYMPH_721       | Lymphoma: Prior Chemotherapy more than 721 days before Episode Start OR No Prior Chemo | Num       | 8           | Lymphoma: Prior Chemotherapy more than 721 days before Episode Start OR No Prior Chemo                                                                                           | Value Codes: 1 = Prior Chemotherapy more than 721 days before episode start OR No Prior Chemo and Cancer Type= "Lymphoma" 0 = No                                                                                                                                         |
| ACTUAL_PMT_DME          | Raw Actual Payment DME                                                                 | Num       | 8           | Total DME line payments during the episode                                                                                                                                       | -                                                                                                                                                                                                                                                                        |
| STANDARD_PMT_DME        | Raw Standardized Payment DME                                                           | Num       | 8           | Total DME standardized line payments during the episode                                                                                                                          | -                                                                                                                                                                                                                                                                        |
| ACTUAL_PMT_INP          | Raw Actual Payment Inpatient                                                           | Num       | 8           | Total inpatient (INP) payments during the episode; Exclude any Inpatient payments associated with list of EOM excluded MS-DRGs codes                                             | -                                                                                                                                                                                                                                                                        |
| STANDARD_PMT_INP        | Raw Standardized Payment Inpatient                                                     | Num       | 8           | Total inpatient (INP) standardized payments during the episode; Exclude any Inpatient payments associated with list of EOM excluded MS-DRGs codes                                | -                                                                                                                                                                                                                                                                        |
| ACTUAL_PMT_HOSPICE      | Raw Actual Payment Hospice                                                             | Num       | 8           | Total hospice payments during the episode                                                                                                                                        | -                                                                                                                                                                                                                                                                        |
| STANDARD_PMT_HOSPICE    | Raw Standardized Payment Hospice                                                       | Num       | 8           | Total hospice standardized payments during the episode                                                                                                                           | -                                                                                                                                                                                                                                                                        |
| ACTUAL_PMT_HHA          | Raw Actual Payment Home Health                                                         | Num       | 8           | Total home health (HHA) payments during the episode                                                                                                                              | -                                                                                                                                                                                                                                                                        |
| STANDARD_PMT_HHA        | Raw Standardized Payment Home Health                                                   | Num       | 8           | Total home health (HHA) standardized payments during the episode                                                                                                                 | -                                                                                                                                                                                                                                                                        |
| ACTUAL_PMT_SNF          | Raw Actual Payment SNF                                                                 | Num       | 8           | Total skilled nursing facility (SNF) payments during the episode                                                                                                                 | -                                                                                                                                                                                                                                                                        |
| STANDARD_PMT_SNF        | Raw Standardized SNF                                                                   | Num       | 8           | Total skilled nursing facility (SNF) standardized payments during the episode                                                                                                    | -                                                                                                                                                                                                                                                                        |
| ACTUAL_PMT_PHY          | Part D 80% of the gross drug cost above OOP threshold (GDCA)                           | Num       | 8           | Total physician (PHY) line payments during the episode. Exclude Carrier lines where the HCPCS code is G9678                                                                      | -                                                                                                                                                                                                                                                                        |
| STANDARD_PMT_PHY        | Raw Standardized Payment Physician                                                     | Num       | 8           | Total physician (PHY) standardized line payments during the episode. Exclude Carrier lines where the HCPCS code is G9678                                                         | -                                                                                                                                                                                                                                                                        |
| ACTUAL_PMT_OUTPATIENT   | Raw Actual Payment Outpatient                                                          | Num       | 8           | Total outpatient (OUT) revenue payments during the episode. Sum of Medicare outpatient revenue payments and Operating Outlier Amount(CLM_VAL_CD="17")                            | -                                                                                                                                                                                                                                                                        |
| STANDARD_PMT_OUTPATIENT | Raw Standardized Payment Outpatient                                                    | Num       | 8           | Total outpatient (OUT) standardized revenue payments during the episode. Sum of Medicare outpatient standardized revenue payments and Operating Outlier Amount (CLM_VAL_CD="17") | -                                                                                                                                                                                                                                                                        |
| PARTD_LICS              | Part D LICS Payments                                                                   | Num       | 8           | Part D LICS Payments                                                                                                                                                             | -                                                                                                                                                                                                                                                                        |
| PARTD_CATAPH            | Part D 80% of the gross drug cost above OOP threshold (GDCA)                           | Num       | 8           | Part D 80% of the gross drug cost above OOP threshold (GDCA)                                                                                                                     | -                                                                                                                                                                                                                                                                        |
| RAW_ACTUAL_PARTA        | Raw Actual Total Episode Payment: Part A                                               | Num       | 8           | Raw Actual Total Episode Payment: Part A                                                                                                                                         | -                                                                                                                                                                                                                                                                        |
| RAW_ACTUAL_PARTB        | Raw Actual Total Episode Payment: Part B                                               | Num       | 8           | Raw Actual Total Episode Payment: Part B                                                                                                                                         | -                                                                                                                                                                                                                                                                        |
| RAW_STANDARD_PARTA      | Raw Standardized Total Episode Payment: Part A                                         | Num       | 8           | Raw Standardized Total Episode Payment: Part A                                                                                                                                   | -                                                                                                                                                                                                                                                                        |
| RAW_STANDARD_PARTB      | Raw Standardized Total Episode Payment: Part B                                         | Num       | 8           | Raw Standardized Total Episode Payment: Part B                                                                                                                                   | -                                                                                                                                                                                                                                                                        |
| RAW_TOTAL               | Raw Actual Total Episode Cost                                                          | Num       | 8           | Sum of actual Medicare payments during the episode                                                                                                                               | -                                                                                                                                                                                                                                                                        |
| RAW_TOTAL_STD           | Raw Standardized Total Episode Cost                                                    | Num       | 8           | Sum of Medicare Standardized payments during the episode                                                                                                                         | -                                                                                                                                                                                                                                                                        |
| TOTAL_NCBP_ADJ          | Total Payments with the non claim based payment adjustments applied                    | Num       | 8           | Total Payments with the non claim based payment adjustments applied during the episode                                                                                           | -                                                                                                                                                                                                                                                                        |
| TOTAL_STD_NCBP_ADJ      | Total Standardized Payments with the non claim based payments adjustments applied      | Num       | 8           | Total Standardized Payments with the non claim based payments adjustments applied during the episode                                                                             | -                                                                                                                                                                                                                                                                        |
| TR_ACTUAL_INP           | Trended Actual Payment Inpatient                                                       | Num       | 8           | Trended Actual Payment Inpatient                                                                                                                                                 | -                                                                                                                                                                                                                                                                        |
| TR_ACTUAL_OUTPATIENT    | Trended Actual Payment Outpatient                                                      | Num       | 8           | Trended Actual Payment Outpatient                                                                                                                                                | -                                                                                                                                                                                                                                                                        |
| TR_ACTUAL_SNF           | Trended Actual Payment SNF                                                             | Num       | 8           | Trended Actual Payment SNF                                                                                                                                                       | -                                                                                                                                                                                                                                                                        |
| TR_ACTUAL_DME           | Trended Actual Payment DME                                                             | Num       | 8           | Trended Actual Payment DME                                                                                                                                                       | -                                                                                                                                                                                                                                                                        |
| TR_ACTUAL_HHA           | Trended Actual Payment Home Health                                                     | Num       | 8           | Trended Actual Payment Home Health                                                                                                                                               | -                                                                                                                                                                                                                                                                        |
| TR_ACTUAL_HOSPICE       | Trended Actual Payment Hospice                                                         | Num       | 8           | Trended Actual Payment Hospice                                                                                                                                                   | -                                                                                                                                                                                                                                                                        |
| TR_ACTUAL_PHY           | Trended Actual Payment Physician                                                       | Num       | 8           | Trended Actual Payment Physician                                                                                                                                                 | -                                                                                                                                                                                                                                                                        |
| TR_STANDARD_INP         | Trended Standardized Payment Inpatient                                                 | Num       | 8           | Trended Standardized Payment Inpatient                                                                                                                                           | -                                                                                                                                                                                                                                                                        |
| TR_STANDARD_OUTPATIENT  | Trended Standardized Payment Outpatient                                                | Num       | 8           | Trended Standardized Payment Outpatient                                                                                                                                          | -                                                                                                                                                                                                                                                                        |
| TR_STANDARD_SNF         | Trended Standardized Payment SNF                                                       | Num       | 8           | Trended Standardized Payment SNF                                                                                                                                                 | -                                                                                                                                                                                                                                                                        |
| TR_STANDARD_DME         | Trended Standardized Payment DME                                                       | Num       | 8           | Trended Standardized Payment DME                                                                                                                                                 | -                                                                                                                                                                                                                                                                        |
| TR_STANDARD_HHA         | Trended Standardized Payment Home Health                                               | Num       | 8           | Trended Standardized Payment Home Health                                                                                                                                         | -                                                                                                                                                                                                                                                                        |
| TR_STANDARD_HOSPICE     | Trended Standardized Payment Hospice                                                   | Num       | 8           | Trended Standardized Payment Hospice                                                                                                                                             | -                                                                                                                                                                                                                                                                        |
| TR_STANDARD_PHY         | Trended Standardized Payment Physician                                                 | Num       | 8           | Trended Standardized Payment Physician                                                                                                                                           | -                                                                                                                                                                                                                                                                        |
| TR_ACTUAL_PARTA         | Trended Actual Payment Part A                                                          | Num       | 8           | Trended Actual Payment Part A                                                                                                                                                    | -                                                                                                                                                                                                                                                                        |
| TR_ACTUAL_PARTB         | Trended Actual Payment Part B                                                          | Num       | 8           | Trended Actual Payment Part B                                                                                                                                                    | -                                                                                                                                                                                                                                                                        |
| TR_STANDARD_PARTA       | Trended Standardized Payment Part A                                                    | Num       | 8           | Trended Standardized Payment Part A                                                                                                                                              | -                                                                                                                                                                                                                                                                        |
| TR_STANDARD_PARTB       | Trended Standardized Payment Part B                                                    | Num       | 8           | Trended Standardized Payment Part B                                                                                                                                              | -                                                                                                                                                                                                                                                                        |
| TOTAL_TRENDED           | Trended Actual Total Episode Cost                                                      | Num       | 8           | Trended Actual Total Episode Cost                                                                                                                                                | -                                                                                                                                                                                                                                                                        |
| TOTAL_STD_TRENDED       | Trended Standardized Total Episode Cost                                                | Num       | 8           | Trended Standardized Total Episode Cost                                                                                                                                          | -                                                                                                                                                                                                                                                                        |
| TOTAL_TRENDED_WINS      | Trended and Winsorized Actual Total Episode Cost                                       | Num       | 8           | Trended and Winsorized Actual Total Episode Cost                                                                                                                                 | -                                                                                                                                                                                                                                                                        |
| TOTAL_STD_TRENDED_WINS  | Trended and Winsorized Standardized Total Episode Cost                                 | Num       | 8           | Trended and Winsorized Standardized Total Episode Cost                                                                                                                           | -                                                                                                                                                                                                                                                                        |
| BREAST_ZERO             | HCC costly Flag count by cancer type                                                   | Num       | 8           | No Costly Chronic Condition: Breast Cancer                                                                                                                                       | Value Codes: 1 = HCC_New=0 and HCC_Breast_count=0 0 = NA                                                                                                                                                                                                                 |
| BREAST_1                | HCC costly Flag count by cancer type                                                   | Num       | 8           | One Costly Chronic Condition: Breast Cancer                                                                                                                                      | Value Codes: 1= HCC_New=0 and HCC_Breast_count=1 0 = NA                                                                                                                                                                                                                  |
| BREAST_2                | HCC costly Flag count by cancer type                                                   | Num       | 8           | Two Costly Chronic Conditions: Breast Cancer                                                                                                                                     | Value Codes: 1 = HCC_New=0 and HCC_Breast_count=2 0 = NA                                                                                                                                                                                                                 |
| BREAST_3                | HCC costly Flag count by cancer type                                                   | Num       | 8           | Three Costly Chronic Conditions: Breast Cancer                                                                                                                                   | Value Codes: 1 = HCC_New=0 and HCC_Breast_count=3                                                                                                                                                                                                                        |
| BREAST_4_MORE           | HCC costly Flag count by cancer type                                                   | Num       | 8           | Four or More Costly Chronic Conditions: Breast Cancer                                                                                                                            | Value Codes: 1 = HCC_New=0 and HCC_Breast_count> 3 0 = NA                                                                                                                                                                                                                |
| CHR_LEUK_ZERO           | HCC costly Flag count by cancer type                                                   | Num       | 8           | No Costly Chronic Condition: Chronic Leukemia                                                                                                                                    | Value Codes: 1 = HCC_New=0 and HCC_Chr_Leuk_count=0                                                                                                                                                                                                                      |
| CHR_LEUK_1              | HCC costly Flag count by cancer type                                                   | Num       | 8           | One Costly Chronic Condition: Chronic Leukemia                                                                                                                                   | Value Codes: 1 = HCC_New=0 and HCC_Chr_Leuk_count=1 0= NA                                                                                                                                                                                                                |
| CHR_LEUK_2              | HCC costly Flag count by cancer type                                                   | Num       | 8           | Two Costly Chronic Conditions: Chronic Leukemia                                                                                                                                  | Value Codes: 1 = HCC_New=0 and HCC_Chr_Leuk_count=2                                                                                                                                                                                                                      |
| CHR_LEUK_3              | HCC costly Flag count by cancer type                                                   | Num       | 8           | Three Costly Chronic Conditions: Chronic Leukemia                                                                                                                                | Value Codes: 1 = HCC_New=0 and HCC_Chr_Leuk_count=3 0 = NA                                                                                                                                                                                                               |
| CHR_LEUK_4_MORE         | HCC costly Flag count by cancer type                                                   | Num       | 8           | Four or More Costly Chronic Conditions: Chronic Leukemia                                                                                                                         | Value Codes: 1 = HCC_New=0 and HCC_Chr_Leuk_count>3 0 = NA                                                                                                                                                                                                               |
| LUNG_ZERO               | HCC costly Flag count by cancer type                                                   | Num       | 8           | No Costly Chronic Condition: Lung Cancer                                                                                                                                         | Value Codes: 1 = HCC_New=0 and HCC_Lung_count=0 0 = NA                                                                                                                                                                                                                   |
| LUNG_1                  | HCC costly Flag count by cancer type                                                   | Num       | 8           | One Costly Chronic Condition: Lung Cancer                                                                                                                                        | Value Codes: 1 = HCC_New=0 and HCC_Lung_count=1 0 = NA                                                                                                                                                                                                                   |
| LUNG_2                  | HCC costly Flag count by cancer type                                                   | Num       | 8           | Two Costly Chronic Conditions: Lung Cancer                                                                                                                                       | Value Codes: 1 = HCC_New=0 and HCC_Lung_count=2 0 = NA                                                                                                                                                                                                                   |
| LUNG_3                  | HCC costly Flag count by cancer type                                                   | Num       | 8           | Three Costly Chronic Conditions: Lung Cancer                                                                                                                                     | Value Codes: 1 = HCC_New=0 and HCC_Lung_count=3 0 = NA                                                                                                                                                                                                                   |
| LUNG_4_MORE             | HCC costly Flag count by cancer type                                                   | Num       | 8           | Four or More Costly Chronic Conditions: Lung Cancer                                                                                                                              | Value Codes: 1 = HCC_New=0 and HCC_Lung_count>4 0 = NA                                                                                                                                                                                                                   |
| LYMPH_ZERO              | HCC costly Flag count by cancer type                                                   | Num       | 8           | No Costly Chronic Condition: Lymphoma                                                                                                                                            | Value Codes: 1 = HCC_New=0 and HCC_Lymph_count=0 0 = NA                                                                                                                                                                                                                  |
| LYMPH_1                 | HCC costly Flag count by cancer type                                                   | Num       | 8           | One Costly Chronic Condition: Lymphoma                                                                                                                                           | Value Codes: 1 = HCC_New=0 and HCC_Lymph_count=1 0 = NA                                                                                                                                                                                                                  |
| LYMPH_2                 | HCC costly Flag count by cancer type                                                   | Num       | 8           | Two Costly Chronic Conditions: Lymphoma                                                                                                                                          | Value Codes: 1 = HCC_New=0 and HCC_Lymph_count=2 0 = NA                                                                                                                                                                                                                  |
| LYMPH_3                 | HCC costly Flag count by cancer type                                                   | Num       | 8           | Three Costly Chronic Conditions: Lymphoma                                                                                                                                        | Value Codes: 1 = HCC_New=0 and HCC_Lymph_count=3 0 = NA                                                                                                                                                                                                                  |
| LYMPH_4_MORE            | HCC costly Flag count by cancer type                                                   | Num       | 8           | Four or More Costly Chronic Conditions: Lymphoma                                                                                                                                 | Value Codes: 1 = HCC_New=0 and HCC_Lymph_count>3 0 = NA                                                                                                                                                                                                                  |
| MULT_MYEL_ZERO          | HCC costly Flag count by cancer type                                                   | Num       | 8           | No Costly Chronic Condition: Multiple Myeloma                                                                                                                                    | Value Codes: 1 = HCC_New=0 and HCC_Mult_myel_count=0 0 = NA                                                                                                                                                                                                              |
| MULT_MYEL_1             | HCC costly Flag count by cancer type                                                   | Num       | 8           | One Costly Chronic Condition: Multiple Myeloma                                                                                                                                   | Value Codes: 1 = HCC_New=0 and HCC_Mult_myel_count=1 0 = NA                                                                                                                                                                                                              |
| MULT_MYEL_2             | HCC costly Flag count by cancer type                                                   | Num       | 8           | Two Costly Chronic Conditions: Multiple Myeloma                                                                                                                                  | Value Codes: 1 = HCC_New=0 and HCC_Mult_myel_count=2 0 = NA                                                                                                                                                                                                              |
| MULT_MYEL_3             | HCC costly Flag count by cancer type                                                   | Num       | 8           | Three Costly Chronic Conditions: Multiple Myeloma                                                                                                                                | Value Codes: 1= HCC_New=0 and HCC_Mult_myel_count=3 0 = NA                                                                                                                                                                                                               |
| MULT_MYEL_4_MORE        | HCC costly Flag count by cancer type                                                   | Num       | 8           | Four or More Costly Chronic Conditions: Multiple Myeloma                                                                                                                         | Value Codes: 1 = HCC_New=0 and HCC_Mult_myel_count>3 0 = NA                                                                                                                                                                                                              |
| PROSTATE_ZERO           | HCC costly Flag count by cancer type                                                   | Num       | 8           | No Costly Chronic Condition: Prostate Cancer                                                                                                                                     | Value Codes: 1 = HCC_New=0 and HCC_Prostate_count=0 0 = NA                                                                                                                                                                                                               |
| PROSTATE_1              | HCC costly Flag count by cancer type                                                   | Num       | 8           | One Costly Chronic Condition: Prostate Cancer                                                                                                                                    | Value Codes: 1 = HCC_New=0 and HCC_Prostate_count=1 0 = NA                                                                                                                                                                                                               |
| PROSTATE_2              | HCC costly Flag count by cancer type                                                   | Num       | 8           | Two Costly Chronic Conditions: Prostate Cancer                                                                                                                                   | Value Codes: 1 = HCC_New=0 and HCC_Prostate_count=2 0 = NA                                                                                                                                                                                                               |
| PROSTATE_3              | HCC costly Flag count by cancer type                                                   | Num       | 8           | Three Costly Chronic Conditions: Prostate Cancer                                                                                                                                 | Value Codes: 1 = HCC_New=0 and HCC_Prostate_count=3 0 = NA                                                                                                                                                                                                               |
| PROSTATE_4_MORE         | HCC costly Flag count by cancer type                                                   | Num       | 8           | Four or More Costly Chronic Conditions: Breast Cancer                                                                                                                            | Value Codes: 1 = HCC_New=0 and HCC_Prostate_count>3 0 = NA                                                                                                                                                                                                               |
| COLON_ZERO              | HCC costly Flag count by cancer type                                                   | Num       | 8           | No Costly Chronic Condition: Colorectal/Small Intestine Cancer                                                                                                                   | Value Codes: 1 = HCC_New=0 and HCC_Colorectal_count=0 0 = NA                                                                                                                                                                                                             |
| COLON_1                 | HCC costly Flag count by cancer type                                                   | Num       | 8           | One Costly Chronic Condition: Colorectal/Small Intestine Cancer                                                                                                                  | Value Codes: 1 = HCC_New=0 and HCC_Colorectal_count=1 0 = NA                                                                                                                                                                                                             |
| COLON_2                 | HCC costly Flag count by cancer type                                                   | Num       | 8           | Two Costly Chronic Conditions: Colorectal/Small Intestine Cancer                                                                                                                 | Value Codes: 1 = HCC_New=0 and HCC_Colorectal_count=2 0 = NA                                                                                                                                                                                                             |
| COLON_3                 | HCC costly Flag count by cancer type                                                   | Num       | 8           | Three Costly Chronic Conditions: Colorectal/Small Intestine Cancer                                                                                                               | Value Codes: 1 = HCC_New=0 and HCC_Colorectal_count=3 0 = NA                                                                                                                                                                                                             |
| COLON_4_MORE            | HCC costly Flag count by cancer type                                                   | Num       | 8           | Four or More Costly Chronic Conditions: Colorectal/Small Intestine Cancer                                                                                                        | Value Codes: 1 = HCC_New=0 and HCC_Colorectal_count>3 0 = NA                                                                                                                                                                                                             |

</details>

```elixir
defmodule EOM_Filters do
  def is_midwest(%{"pgp_id_region" => "Midwest Region"}), do: true
  def is_midwest(_), do: false

  def is_northeast(%{"pgp_id_region" => "Northeast Region"}), do: true
  def is_northeast(_), do: false

  def is_south(%{"pgp_id_region" => "South Region"}), do: true
  def is_south(_), do: false

  def is_west(%{"pgp_id_region" => "West Region"}), do: true
  def is_west(_), do: false

  def is_rural(%{"FORHP_RURAL_IND" => "1"}), do: true
  def is_rural(_), do: false

  def is_not_rural(%{"FORHP_RURAL_IND" => "0"}), do: true
  def is_not_rural(_), do: false

  def predicate_groupings do
    [
      {"National, Both", [fn _ -> true end]},
      {"National, Rural", [&is_rural/1]},
      {"National, Urban", [&is_not_rural/1]},
      {"Midwest, Both", [&is_midwest/1]},
      {"Midwest, Rural", [&is_midwest/1, &is_rural/1]},
      {"Midwest, Urban", [&is_midwest/1, &is_not_rural/1]},
      {"South, Both", [&is_south/1]},
      {"South, Rural", [&is_south/1, &is_rural/1]},
      {"South, Urban", [&is_south/1, &is_not_rural/1]},
      {"Northeast, Both", [&is_northeast/1]},
      {"Northeast, Rural", [&is_northeast/1, &is_rural/1]},
      {"Northeast, Urban", [&is_northeast/1, &is_not_rural/1]},
      {"West, Both", [&is_west/1]},
      {"West, Rural", [&is_west/1, &is_rural/1]},
      {"West, Urban", [&is_west/1, &is_not_rural/1]}
    ]
    |> Enum.map(fn {name, predicates} ->
      {name, &Enum.all?(predicates, fn pred -> pred.(&1) end)}
    end)
  end
end

defmodule MyMap do
  def update(map, key, default, fun) when is_map(map) and is_function(fun, 1) do
    Map.put(map, key, Map.get(map, key, default) |> fun.())
  end
end
```

<!-- livebook:{"output":true} -->

```
{:module, MyMap, <<70, 79, 82, 49, 0, 0, 7, ...>>, {:update, 4}}
```

## averages

Gets all the counts for each cancer type and then divides the Raw Total Standardized cost by those counts.

```elixir
defmodule EOM_Data do
  def calc(data_stream) do
    predicate_groupings = EOM_Filters.predicate_groupings()

    data_stream
    |> Enum.reduce(%{}, fn row, tent ->
      pennies =
        if(String.contains?(row["raw_total_std"], "."),
          do: row["raw_total_std"],
          else: row["raw_total_std"] <> ".00"
        )
        |> String.to_float()
        |> then(&(100 * &1))
        |> Kernel.round()

      predicate_groupings
      |> Enum.reduce(tent, fn {grp_name, predicate}, tent ->
        if predicate.(row) do
          MyMap.update(tent, grp_name, %{}, fn section ->
            MyMap.update(section, row["cancer_type"], {0, 0}, fn
              {count, running_total} ->
                {count + 1, running_total + pennies}
            end)
          end)
        else
          tent
        end
      end)
    end)
    |> Map.to_list()
    |> Enum.map(fn {name, details} ->
      {name,
       details
       |> Map.to_list()
       |> Enum.map(fn {cancer, {count, total_cost}} ->
         {cancer,
          %{
            "people" => count,
            "total_cost" => (total_cost / 100) |> Float.round(2),
            "avg" => (total_cost / count / 100) |> Float.round(2)
          }}
       end)
       |> Enum.into(%{})}
    end)
    |> Enum.into(%{})
  end
end

EOM_Data.calc(data_stream)
```

<!-- livebook:{"output":true} -->

```
%{
  "Midwest, Both" => %{
    "Breast Cancer" => %{"avg" => 49600.28, "people" => 8654, "total_cost" => 429240820.72},
    "Chronic Leukemia" => %{"avg" => 60069.16, "people" => 3616, "total_cost" => 217210088.27},
    "Lung Cancer" => %{"avg" => 65769.33, "people" => 10003, "total_cost" => 657890596.76},
    "Lymphoma" => %{"avg" => 57904.86, "people" => 4893, "total_cost" => 283328462.75},
    "Multiple Myeloma" => %{"avg" => 87925.98, "people" => 6141, "total_cost" => 539953469.62},
    "Prostate Cancer" => %{"avg" => 49008.8, "people" => 4242, "total_cost" => 207895325.72},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 40679.47,
      "people" => 4741,
      "total_cost" => 192861359.85
    }
  },
  "Midwest, Rural" => %{
    "Breast Cancer" => %{"avg" => 49757.97, "people" => 1469, "total_cost" => 73094463.51},
    "Chronic Leukemia" => %{"avg" => 59354.63, "people" => 692, "total_cost" => 41073404.02},
    "Lung Cancer" => %{"avg" => 65147.8, "people" => 1892, "total_cost" => 123259645.14},
    "Lymphoma" => %{"avg" => 54058.24, "people" => 829, "total_cost" => 44814280.34},
    "Multiple Myeloma" => %{"avg" => 88614.76, "people" => 980, "total_cost" => 86842465.33},
    "Prostate Cancer" => %{"avg" => 52774.43, "people" => 703, "total_cost" => 37100422.87},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 40586.27,
      "people" => 1056,
      "total_cost" => 42859098.04
    }
  },
  "Midwest, Urban" => %{
    "Breast Cancer" => %{"avg" => 49568.04, "people" => 7185, "total_cost" => 356146357.21},
    "Chronic Leukemia" => %{"avg" => 60238.26, "people" => 2924, "total_cost" => 176136684.25},
    "Lung Cancer" => %{"avg" => 65914.31, "people" => 8111, "total_cost" => 534630951.62},
    "Lymphoma" => %{"avg" => 58689.51, "people" => 4064, "total_cost" => 238514182.41},
    "Multiple Myeloma" => %{"avg" => 87795.2, "people" => 5161, "total_cost" => 453111004.29},
    "Prostate Cancer" => %{"avg" => 48260.78, "people" => 3539, "total_cost" => 170794902.85},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 40706.18,
      "people" => 3685,
      "total_cost" => 150002261.81
    }
  },
  "National, Both" => %{
    "Breast Cancer" => %{"avg" => 48416.43, "people" => 40321, "total_cost" => 1952198785.31},
    "Chronic Leukemia" => %{"avg" => 59440.23, "people" => 14932, "total_cost" => 887561462.25},
    "Lung Cancer" => %{"avg" => 66010.11, "people" => 41388, "total_cost" => 2732026543.35},
    "Lymphoma" => %{"avg" => 57264.45, "people" => 21583, "total_cost" => 1235938549.21},
    "Multiple Myeloma" => %{"avg" => 88963.93, "people" => 27422, "total_cost" => 2439568999.95},
    "Prostate Cancer" => %{"avg" => 49658.84, "people" => 18755, "total_cost" => 931351560.1},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 39625.21,
      "people" => 20371,
      "total_cost" => 807205204.85
    }
  },
  "National, Rural" => %{
    "Breast Cancer" => %{"avg" => 48583.37, "people" => 4465, "total_cost" => 216924737.03},
    "Chronic Leukemia" => %{"avg" => 58647.5, "people" => 1910, "total_cost" => 112016726.5},
    "Lung Cancer" => %{"avg" => 63054.5, "people" => 5515, "total_cost" => 347745550.0},
    "Lymphoma" => %{"avg" => 53273.77, "people" => 2458, "total_cost" => 130946920.31},
    "Multiple Myeloma" => %{"avg" => 87567.9, "people" => 2975, "total_cost" => 260514504.23},
    "Prostate Cancer" => %{"avg" => 51262.14, "people" => 2169, "total_cost" => 111187582.85},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 38202.07,
      "people" => 2951,
      "total_cost" => 112734311.91
    }
  },
  "National, Urban" => %{
    "Breast Cancer" => %{"avg" => 48395.64, "people" => 35856, "total_cost" => 1735274048.28},
    "Chronic Leukemia" => %{"avg" => 59556.5, "people" => 13022, "total_cost" => 775544735.75},
    "Lung Cancer" => %{"avg" => 66464.5, "people" => 35873, "total_cost" => 2384280993.35},
    "Lymphoma" => %{"avg" => 57777.34, "people" => 19125, "total_cost" => 1104991628.9},
    "Multiple Myeloma" => %{"avg" => 89133.82, "people" => 24447, "total_cost" => 2179054495.72},
    "Prostate Cancer" => %{"avg" => 49449.17, "people" => 16586, "total_cost" => 820163977.25},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 39866.3,
      "people" => 17420,
      "total_cost" => 694470892.94
    }
  },
  "Northeast, Both" => %{
    "Breast Cancer" => %{"avg" => 47999.09, "people" => 7523, "total_cost" => 361097190.49},
    "Chronic Leukemia" => %{"avg" => 59578.98, "people" => 2977, "total_cost" => 177366631.75},
    "Lung Cancer" => %{"avg" => 66217.25, "people" => 7857, "total_cost" => 520268908.07},
    "Lymphoma" => %{"avg" => 58225.05, "people" => 4183, "total_cost" => 243555377.35},
    "Multiple Myeloma" => %{"avg" => 91791.33, "people" => 5462, "total_cost" => 501364225.74},
    "Prostate Cancer" => %{"avg" => 47167.83, "people" => 3877, "total_cost" => 182869665.72},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 40613.69,
      "people" => 3672,
      "total_cost" => 149133478.5
    }
  },
  "Northeast, Rural" => %{
    "Breast Cancer" => %{"avg" => 48377.02, "people" => 569, "total_cost" => 27526527.08},
    "Chronic Leukemia" => %{"avg" => 59474.69, "people" => 230, "total_cost" => 13679178.95},
    "Lung Cancer" => %{"avg" => 63072.94, "people" => 687, "total_cost" => 43331107.95},
    "Lymphoma" => %{"avg" => 53031.69, "people" => 369, "total_cost" => 19568694.97},
    "Multiple Myeloma" => %{"avg" => 89600.56, "people" => 406, "total_cost" => 36377826.93},
    "Prostate Cancer" => %{"avg" => 48708.51, "people" => 323, "total_cost" => 15732847.68},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 37713.47,
      "people" => 337,
      "total_cost" => 12709439.16
    }
  },
  "Northeast, Urban" => %{
    "Breast Cancer" => %{"avg" => 47968.17, "people" => 6954, "total_cost" => 333570663.41},
    "Chronic Leukemia" => %{"avg" => 59587.71, "people" => 2747, "total_cost" => 163687452.8},
    "Lung Cancer" => %{"avg" => 66518.52, "people" => 7170, "total_cost" => 476937800.12},
    "Lymphoma" => %{"avg" => 58727.5, "people" => 3814, "total_cost" => 223986682.38},
    "Multiple Myeloma" => %{"avg" => 91967.25, "people" => 5056, "total_cost" => 464986398.81},
    "Prostate Cancer" => %{"avg" => 47027.8, "people" => 3554, "total_cost" => 167136818.04},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 40906.76,
      "people" => 3335,
      "total_cost" => 136424039.34
    }
  },
  "South, Both" => %{
    "Breast Cancer" => %{"avg" => 48297.9, "people" => 16074, "total_cost" => 776340424.48},
    "Chronic Leukemia" => %{"avg" => 58721.47, "people" => 5569, "total_cost" => 327019848.7},
    "Lung Cancer" => %{"avg" => 64943.5, "people" => 16760, "total_cost" => 1088453112.03},
    "Lymphoma" => %{"avg" => 56110.76, "people" => 8273, "total_cost" => 464204347.23},
    "Multiple Myeloma" => %{"avg" => 87713.3, "people" => 10573, "total_cost" => 927392672.47},
    "Prostate Cancer" => %{"avg" => 51571.1, "people" => 6427, "total_cost" => 331447469.61},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 38646.46,
      "people" => 8252,
      "total_cost" => 318910621.08
    }
  },
  "South, Rural" => %{
    "Breast Cancer" => %{"avg" => 48273.81, "people" => 1795, "total_cost" => 86651480.66},
    "Chronic Leukemia" => %{"avg" => 58550.9, "people" => 751, "total_cost" => 43971723.93},
    "Lung Cancer" => %{"avg" => 61181.94, "people" => 2344, "total_cost" => 143410472.44},
    "Lymphoma" => %{"avg" => 53473.71, "people" => 921, "total_cost" => 49249283.43},
    "Multiple Myeloma" => %{"avg" => 85612.44, "people" => 1171, "total_cost" => 100252166.29},
    "Prostate Cancer" => %{"avg" => 52629.11, "people" => 763, "total_cost" => 40156009.27},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 36898.1,
      "people" => 1221,
      "total_cost" => 45052584.72
    }
  },
  "South, Urban" => %{
    "Breast Cancer" => %{"avg" => 48300.93, "people" => 14279, "total_cost" => 689688943.82},
    "Chronic Leukemia" => %{"avg" => 58748.05, "people" => 4818, "total_cost" => 283048124.77},
    "Lung Cancer" => %{"avg" => 65555.12, "people" => 14416, "total_cost" => 945042639.59},
    "Lymphoma" => %{"avg" => 56441.11, "people" => 7352, "total_cost" => 414955063.8},
    "Multiple Myeloma" => %{"avg" => 87974.95, "people" => 9402, "total_cost" => 827140506.18},
    "Prostate Cancer" => %{"avg" => 51428.58, "people" => 5664, "total_cost" => 291291460.34},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 38950.08,
      "people" => 7031,
      "total_cost" => 273858036.36
    }
  },
  "West, Both" => %{
    "Breast Cancer" => %{"avg" => 47859.63, "people" => 8011, "total_cost" => 383403500.43},
    "Chronic Leukemia" => %{"avg" => 59926.69, "people" => 2756, "total_cost" => 165157944.61},
    "Lung Cancer" => %{"avg" => 68774.89, "people" => 6737, "total_cost" => 463336428.22},
    "Lymphoma" => %{"avg" => 57885.75, "people" => 4217, "total_cost" => 244104215.83},
    "Multiple Myeloma" => %{"avg" => 89908.18, "people" => 5203, "total_cost" => 467792282.04},
    "Prostate Cancer" => %{"avg" => 49766.57, "people" => 4183, "total_cost" => 208173564.05},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 39579.53,
      "people" => 3677,
      "total_cost" => 145533942.12
    }
  },
  "West, Rural" => %{
    "Breast Cancer" => %{"avg" => 46918.14, "people" => 632, "total_cost" => 29652265.78},
    "Chronic Leukemia" => %{"avg" => 56086.16, "people" => 237, "total_cost" => 13292419.6},
    "Lung Cancer" => %{"avg" => 63757.3, "people" => 592, "total_cost" => 37744324.47},
    "Lymphoma" => %{"avg" => 51075.7, "people" => 339, "total_cost" => 17314661.57},
    "Multiple Myeloma" => %{"avg" => 88617.33, "people" => 418, "total_cost" => 37042045.68},
    "Prostate Cancer" => %{"avg" => 47890.27, "people" => 380, "total_cost" => 18198303.03},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 35944.18,
      "people" => 337,
      "total_cost" => 12113189.99
    }
  },
  "West, Urban" => %{
    "Breast Cancer" => %{"avg" => 47940.27, "people" => 7379, "total_cost" => 353751234.65},
    "Chronic Leukemia" => %{"avg" => 60288.02, "people" => 2519, "total_cost" => 151865525.01},
    "Lung Cancer" => %{"avg" => 69258.28, "people" => 6145, "total_cost" => 425592103.75},
    "Lymphoma" => %{"avg" => 58481.06, "people" => 3878, "total_cost" => 226789554.26},
    "Multiple Myeloma" => %{"avg" => 90020.95, "people" => 4785, "total_cost" => 430750236.36},
    "Prostate Cancer" => %{"avg" => 49954.05, "people" => 3803, "total_cost" => 189975261.02},
    "Small Intestine / Colorectal Cancer" => %{
      "avg" => 39946.33,
      "people" => 3340,
      "total_cost" => 133420752.13
    }
  }
}
```

~Only took 1135 seconds. 😅~  
~Down to... 22.4 seconds. A pretty nice improvement.~  
~Now 11.1 seconds. Half the time for just defining a module (for compilation benefits)~  
Do the same thing again: 3.6 seconds.
